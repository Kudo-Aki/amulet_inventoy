# マスタ編集・QRコード発行ガイド

このガイドでは、新しいお守りを追加（マスタ編集）し、そのお守り用のQRコードを発行（ラベル印刷）する方法を説明します。

---

## 全体の流れ

新しいお守りを導入する場合、以下の流れで作業します。

```
1. 管理メニューを開く
      ↓
2. 商品マスタを編集して、新しいお守りを追加する
      ↓
3. QRコード発行ツールで、新しいお守りのQRコードを作成・印刷する
      ↓
4. 印刷したラベルシールを箱に貼り付ける
      ↓
完了！ いつも通り納品・棚卸作業ができます
```

---

## STEP 1：管理メニューを開く

1. いつも通り、ホーム画面のアイコンからアプリを開きます。
2. 画面右上の「**⚙️**」（歯車マーク）をタップします。
3. 「管理メニュー」が開きます。

| メニュー | 説明 |
|---|---|
| **商品マスタ編集** | お守りの種類や入数を追加・変更する |
| **QRコード発行** | 箱に貼るQRコードを印刷用に作成する |

---

## STEP 2：商品マスタを編集する

「**商品マスタ編集**」をタップして、編集画面を開きます。

### 新しいお守りを追加する方法

1. 画面下部の「**商品追加**」フォームに入力します。

   | 項目 | 入力例 | 説明 |
   |---|---|---|
   | **商品コード** | `YAKUYOKE` | **英大文字のみ**。他の商品と重複しないように。 |
   | **商品名** | `厄除け守り` | アプリに表示される名前。 |
   | **入数** | `50` | 1箱あたりのお守りの個数。 |

2. 「**追加**」ボタンを押します。
3. 上の「現在の商品マスタ」一覧に追加されれば成功です。

### 既存のお守りを編集・削除する方法

- **編集する場合**：一覧のテキストボックスを直接編集します。変更は自動で反映されます。
- **削除する場合**：「**削除**」ボタンを押します。確認メッセージが表示された後、削除されます。

### 最後に必ず「保存」する

編集が終わったら、必ず「**💾 ブラウザに保存**」ボタンを押してください。
これを押さないと、ブラウザを閉じたときに変更内容が消えてしまいます。

> **GitHub Pagesを更新する場合**
> アプリのファイルを更新（`app.js`を差し替え）する場合は、「**📤 エクスポート（app.js用）**」を使い、出力されたテキストで`app.js`内の`DEFAULT_MASTER`を上書きしてください。

---

## STEP 3：QRコードを発行する

管理メニューから「**QRコード発行**」をタップして、発行画面を開きます。

### 1. 発行設定を入力する

| 項目 | 入力例 | 説明 |
|---|---|---|
| **商品** | `厄除け守り` | 先ほど追加した商品を選択します。 |
| **年度** | `25` | 西暦の下2桁（例：2025年なら25） |
| **開始番号** | `1` | 連番の開始番号。通常は1から。 |
| **発行枚数** | `20` | 作成したいQRコードの枚数。 |

> **開始番号のヒント**
> 画面下部の「発行履歴」を見ると、その商品で最後に発行した連番がわかります。続きの番号から発行したい場合は、その次の番号を開始番号に設定します。（例：最終連番が50なら、開始番号を51にする）

### 2. ラベルサイズを選ぶ

印刷したいラベルシールのサイズに合わせて「**小・中・大**」から選びます。

### 3. QRコードを生成する

「**QRコードを生成**」ボタンを押すと、プレビューが表示されます。

### 4. 印刷する

1. 「**🖨️ 印刷**」ボタンを押します。
2. ブラウザの印刷プレビューが表示されます。
3. **ご使用のラベルシールに合わせて**、以下の設定を確認・変更してください。
   - 用紙サイズ
   - 余白（「なし」または「最小」を推奨）
   - 倍率（「用紙に合わせる」ではなく「100%」または「カスタム」）

4. 設定が完了したら、印刷を実行します。

> **印刷のコツ**
> - 最初に普通紙で試し刷りをして、ラベルの位置が合っているか確認することをおすすめします。
> - 「画像をまとめてダウンロード」ボタンで、QRコードを画像ファイルとして保存することもできます。

---

## よくある質問

### Q: 商品コードは何でもいいですか？

**A:** はい。ただし、**半角の英大文字のみ**で、他の商品と重複しないユニークなものにしてください。（例：`KENKO`, `KINUN`, `ENMUSUBI`）

### Q: 間違えて発行したQRコードは使えますか？

**A:** はい、使えます。ただし、連番が飛んでしまうので、管理上は破棄して、正しい設定で再発行することをおすすめします。

### Q: 発行履歴は他の人にも見えますか？

**A:** いいえ。発行履歴は、操作した人のブラウザにのみ保存されます。他の人とは共有されません。

### Q: 印刷がうまくいきません。

**A:** ブラウザの印刷設定は非常に複雑です。以下の点を確認してください。
- **余白設定**：印刷プレビューで「余白」を「なし」に設定してみてください。
- **倍率設定**：「用紙に合わせる」のチェックを外し、倍率を100%にしてみてください。
- **ヘッダーとフッター**：印刷オプションで「ヘッダーとフッター」のチェックを外すと、余計なURLなどが印刷されなくなります。

---

*このガイドは、お守り在庫管理アプリ v2.0 に対応しています。*
